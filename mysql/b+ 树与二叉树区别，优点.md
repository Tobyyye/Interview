- b+ 树与二叉树区别，优点？为什么不用[红黑树]()？ 

B+树的检索过程
我们再来看下B+树的检索过程

从B+树的根开始，逐层找到叶子节点。
找到叶子节点为对应的数据页，将数据叶加载到内存中，通过页目录的槽采用二分查找的方式先找到一个粗略的记录分组。
在分组中通过链表遍历的方式进行记录的查找。
为什么要用B+树索引
数据库访问数据要通过页，一个页就是一个B+树节点，访问一个节点相当于一次I/O操作，所以越快能找到节点，查找性能越好。
B+树的特点就是够矮够胖，能有效地减少访问节点次数从而提高性能。

下面，我们来对比一个二叉树、多叉树、B树和B+树。

二叉树

![img](https://img-blog.csdnimg.cn/img_convert/98a44dd3e7383a49ec15cd125c71a934.png)

二叉树是一种二分查找树，有很好的查找性能，相当于二分查找。
但是当N比较大的时候，树的深度比较高。数据查询的时间主要依赖于磁盘IO的次数，二叉树深度越大，查找的次数越多，性能越差。
最坏的情况是退化成了链表，如下图

![img](https://img-blog.csdnimg.cn/img_convert/9b4727f2fe3e5815432573a0fedb18aa.png)


为了让二叉树不至于退化成链表，人们发明了AVL树（平衡二叉搜索树）：任何结点的左子树和右子树高度最多相差1

多叉树

多叉树就是节点可以是M个，能有效地减少高度，高度变小后，节点变少I/O自然少，性能比二叉树好了





https://www.cnblogs.com/jiading/articles/12571642.html

# 为什么 Mysql 用 B + 树做索引而不用 B 树或红黑树

**B + 树只有叶节点存放数据，其余节点用来索引，而 B -树是每个索引节点都会有 Data 域。**所以从 Mysql（Inoodb）的角度来看，B + 树是用来充当索引的，一般来说索引非常大，尤其是关系性数据库这种数据量大的索引能达到亿级别，所以为了减少内存的占用，索引也会被存储在磁盘上。
**那么 Mysql 如何衡量查询效率呢？– 磁盘 IO 次数。** B - 树 / B + 树 的特点就是每层节点数目非常多，层数很少，目的就是为了就少磁盘 IO 次数，但是 B - 树的每个节点都有 data 域（指针），这无疑增大了节点大小，说白了增加了磁盘 IO 次数（磁盘 IO 一次读出的数据量大小是固定的，单个数据变大，每次读出的就少，IO 次数增多，一次 IO 多耗时），而 B + 树除了叶子节点其它节点并不存储数据，节点小，磁盘 IO 次数就少。**这是优点之一。**
**另一个优点是：** B + 树所有的 Data 域在叶子节点，一般来说都会进行一个优化，就是**将所有的叶子节点用指针串起来**。这样**遍历**叶子节点就能获得全部数据，这样就能进行区间访问啦。在数据库中基于范围的查询是非常频繁的，而 B 树不支持这样的遍历操作。

https://blog.csdn.net/diyao4335/article/details/102006385

**正是由于磁盘IO是非常昂贵的操作，所以计算机操作系统对此做了优化：预读；每一次IO时，不仅仅把当前磁盘地址的数据加载到内存，同时也把相邻数据也加载到内存缓冲区中。因为局部预读原理说明：当访问一个地址数据的时候，与其相邻的数据很快也会被访问到。每次磁盘IO读取的数据我们称之为一页（page）。一页的大小与操作系统有关，一般为4k或者8k。这也就意味着读取一页内数据的时候，实际上发生了一次磁盘IO**

 为什么二叉树的节点过多会增加IO

红黑树的实现是基于二叉树的结构，这就造成了逻辑上很近的节点（父子）物理上可能很远，无法利用空间局部性的原理，像楼主说的每次加载好几层，但是这些数据在物理上是分散的，相当于是随机IO，速度会非常慢。而在B+树的实现中，每个节点存储了多个关键字，这些关键字往往是以数组的形式存储的，数组一般在物理上是连续的，所以B+树的同一个节点的数据可以存储在同一个页中，每次IO操作只需要读取该页即可，效率很高



##### B 树相对于红黑树的区别

**AVL 树和红黑树基本都是存储在内存中才会使用的数据结构**。在大规模数据存储的时候，红黑树往往出现由于**树的深度过大**而造成磁盘 IO 读写过于频繁，进而导致效率低下的情况。为什么会出现这样的情况，我们知道要获取磁盘上数据，必须先通过磁盘移动臂移动到数据所在的柱面，然后找到指定盘面，接着旋转盘面找到数据所在的磁道，最后对数据进行读写。磁盘 IO 代价主要花费在查找所需的柱面上，树的深度过大会造成磁盘 IO 频繁读写。根据**磁盘查找存取的次数往往由树的高度所决定**，所以，只要我们通过某种较好的树结构减少树的结构尽量减少树的高度，B 树可以有多个子女，从几十到上千，可以降低树的高度。



## 平衡二叉树不足

- 考虑到极端情况下，每次插入的数据都比上一次插入的数据大，那么用平衡二叉树就会以线性方式进行存储，时间复杂度为O(n)。数据量很大时，在mysql中一张表存储百万条数据是很正常的一件事，这样会导致树的深度更深，mysql读取时消耗大量io。
- mysql进行过磁盘读取时，是以页为单位进行读取，每个节点表示一页。而平衡二叉树每个节点存储一个关键词，导致存储空间被浪费。

## B-树相比平衡二叉树优点

- 每个节点存储多个多个关键词，合理利用空间大小，每次mysql进行读取时，都会进行预读取，每次把该节点数据读取出来并存储到内存中
- B-树中每个节点存储的关键词变多，导致存储相同数量的数据，B-树的深度相比平衡二叉树深度更浅，减少了数据的查找次数和复杂度

## B+树对比红黑树

- 红黑树多用于内部排序，即全放在内存中
- B+树多用于外存上时，B+也被成为一个磁盘友好的数据结构
- 红黑树和平衡二叉树有相同缺点，每个节点存储一个关键词，数据量大时，导致红黑树的深度很深，mysql每次读取时消耗大量io